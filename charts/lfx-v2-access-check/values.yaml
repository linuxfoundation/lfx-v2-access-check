# Copyright The Linux Foundation and each contributor to LFX.
# SPDX-License-Identifier: MIT
---
replicaCount: 3

lfx:
  domain: k8s.orb.local

# Override from CLI/CI: --set image.tag=<git-sha>, etc.
image:
  repository: ghcr.io/linuxfoundation/lfx-v2-access-check/lfx-access-check
  pullPolicy: IfNotPresent
  # Container image tag, Defaults to appVersion from Chart.yaml if not set
  tag: ""

# Application configuration
app:
  # Server configuration
  port: 8080
  host: "*"
  debug: false

  # JWT/Auth configuration
  audience: "lfx-v2-access-check"
  issuer: "heimdall"

  # Resource limits and requests
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  # extraEnv allows injecting additional environment variables into the container.
  # Supports both simple key-value pairs and Kubernetes field references.
  # These are rendered BEFORE OTEL variables, allowing use in OTEL configuration.
  extraEnv: []

  # otel is the configuration for OpenTelemetry tracing
  otel:
    # serviceName is the service name for OpenTelemetry resource identification
    # (default: "lfx-v2-access-check")
    serviceName: ""
    # serviceVersion is the service version for OpenTelemetry resource identification
    # (default: "1.0.0")
    serviceVersion: ""
    # protocol specifies the OTLP protocol: "grpc" or "http"
    # (default: "grpc")
    protocol: "grpc"
    # endpoint is the OTLP collector endpoint
    # For gRPC: typically "host:4317", for HTTP: typically "host:4318"
    endpoint: ""
    # insecure disables TLS for the OTLP connection
    # Set to "true" for in-cluster communication without TLS
    insecure: "false"
    # tracesExporter specifies the traces exporter: "otlp" or "none"
    # (default: "none")
    tracesExporter: "none"
    # tracesSampleRatio specifies the sampling ratio for traces (0.0 to 1.0)
    # A value of 1.0 means all traces are sampled, 0.5 means 50% are sampled
    # (default: "1.0")
    tracesSampleRatio: "1.0"
    # metricsExporter specifies the metrics exporter: "otlp" or "none"
    # (default: "none")
    metricsExporter: "none"
    # logsExporter specifies the logs exporter: "otlp" or "none"
    # (default: "none")
    logsExporter: "none"
    # propagators specifies the context propagators to use
    # Comma-separated list: "tracecontext", "baggage", "jaeger"
    # (default: "tracecontext,baggage")
    propagators: "tracecontext,baggage,jaeger"

# HTTP routing configuration
traefik:
  enabled: true
  gateway:
    name: lfx-platform-gateway
    namespace: lfx

# nats is the configuration for the NATS server
nats:
  # url is the URL of the NATS server
  url: nats://lfx-platform-nats.lfx.svc.cluster.local:4222

# heimdall is the configuration for the heimdall middleware
heimdall:
  enabled: true
  url: http://lfx-platform-heimdall.lfx.svc.cluster.local:4456
  jwks_url: http://lfx-platform-heimdall:4457/.well-known/jwks
